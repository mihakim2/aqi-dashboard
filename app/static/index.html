<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Quality Dashboard - West Roseville</title>
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
</head>
<body>
    <div class="dashboard">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>ğŸŒ¬ï¸ Air Quality Dashboard</h1>
                <div class="sensor-info">
                    <span id="sensorName">Loading...</span>
                    <span class="location">ğŸ“ West Roseville, CA</span>
                </div>
            </div>
            <div class="last-update">
                Last updated: <span id="lastUpdate">--</span>
                <button id="refreshBtn" class="refresh-btn" title="Refresh">ğŸ”„</button>
            </div>
        </header>

        <!-- Main AQI Display -->
        <section class="aqi-hero">
            <div class="aqi-gauge" id="aqiGauge">
                <div class="aqi-value" id="aqiValue">--</div>
                <div class="aqi-label">AQI</div>
            </div>
            <div class="aqi-details">
                <div class="aqi-category" id="aqiCategory">Loading...</div>
                <p class="aqi-message" id="aqiMessage">Fetching air quality data...</p>
                <div class="cigarettes-info">
                    <span class="cigarette-icon">ğŸš¬</span>
                    <span class="cigarette-value"><span id="cigarettes">--</span> cigarettes/day equivalent</span>
                </div>
            </div>
        </section>

        <!-- Current Readings -->
        <section class="readings-grid">
            <div class="reading-card">
                <div class="reading-icon">ğŸ’¨</div>
                <div class="reading-value"><span id="pm25">--</span> <small>Âµg/mÂ³</small></div>
                <div class="reading-label">PM2.5</div>
            </div>
            <div class="reading-card">
                <div class="reading-icon">ğŸŒ«ï¸</div>
                <div class="reading-value"><span id="pm10">--</span> <small>Âµg/mÂ³</small></div>
                <div class="reading-label">PM10</div>
            </div>
            <div class="reading-card">
                <div class="reading-icon">ğŸŒ¡ï¸</div>
                <div class="reading-value"><span id="temperature">--</span><small>Â°F</small></div>
                <div class="reading-label">Temperature</div>
            </div>
            <div class="reading-card">
                <div class="reading-icon">ğŸ’§</div>
                <div class="reading-value"><span id="humidity">--</span><small>%</small></div>
                <div class="reading-label">Humidity</div>
            </div>
            <div class="reading-card">
                <div class="reading-icon">ğŸ“Š</div>
                <div class="reading-value"><span id="pressure">--</span> <small>hPa</small></div>
                <div class="reading-label">Pressure</div>
            </div>
            <div class="reading-card">
                <div class="reading-icon">âœ…</div>
                <div class="reading-value"><span id="confidence">--</span><small>%</small></div>
                <div class="reading-label">Confidence</div>
            </div>
        </section>

        <!-- AQI Scale Reference -->
        <section class="aqi-scale">
            <h3>AQI Scale</h3>
            <div class="scale-bar">
                <div class="scale-segment good">
                    <div class="scale-range">0-50</div>
                    <div class="scale-name">Good</div>
                    <div class="scale-cig">0-0.5 ğŸš¬</div>
                </div>
                <div class="scale-segment moderate">
                    <div class="scale-range">51-100</div>
                    <div class="scale-name">Moderate</div>
                    <div class="scale-cig">0.5-1.6 ğŸš¬</div>
                </div>
                <div class="scale-segment usg">
                    <div class="scale-range">101-150</div>
                    <div class="scale-name">USG</div>
                    <div class="scale-cig">1.6-2.5 ğŸš¬</div>
                </div>
                <div class="scale-segment unhealthy">
                    <div class="scale-range">151-200</div>
                    <div class="scale-name">Unhealthy</div>
                    <div class="scale-cig">2.5-6.8 ğŸš¬</div>
                </div>
                <div class="scale-segment very-unhealthy">
                    <div class="scale-range">201-300</div>
                    <div class="scale-name">Very Unhealthy</div>
                    <div class="scale-cig">6.8-11.4 ğŸš¬</div>
                </div>
                <div class="scale-segment hazardous">
                    <div class="scale-range">301+</div>
                    <div class="scale-name">Hazardous</div>
                    <div class="scale-cig">11.4+ ğŸš¬</div>
                </div>
            </div>
        </section>

        <!-- Trend Charts -->
        <section class="charts-section">
            <div class="chart-header">
                <div class="chart-tabs">
                    <button class="chart-tab active" data-period="24h">24 Hours</button>
                    <button class="chart-tab" data-period="7d">7 Days</button>
                    <button class="chart-tab" data-period="30d">30 Days</button>
                </div>
                <div class="chart-legend" id="chartLegend">
                    <span class="legend-item"><span class="legend-line"></span> AQI</span>
                    <span class="legend-item iqr-legend" style="display:none;"><span class="legend-band"></span> IQR Range</span>
                </div>
            </div>
            <div class="chart-container">
                <canvas id="trendChart"></canvas>
            </div>
            <div class="chart-stats" id="chartStats">
                <div class="stat">
                    <span class="stat-label">Average AQI</span>
                    <span class="stat-value" id="avgAqi">--</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Max AQI</span>
                    <span class="stat-value" id="maxAqi">--</span>
                </div>
                <div class="stat">
                    <span class="stat-label">Min AQI</span>
                    <span class="stat-value" id="minAqi">--</span>
                </div>
                <div class="stat">
                    <span class="stat-label">IQR (Q1-Q3)</span>
                    <span class="stat-value" id="iqrRange">--</span>
                </div>
                <div class="stat">
                    <span class="stat-label">ğŸš¬ Avg/Day</span>
                    <span class="stat-value" id="avgCigarettes">--</span>
                </div>
            </div>
        </section>

        <!-- Nearby Sensors -->
        <section class="nearby-section">
            <h3>ğŸ“ Nearby Sensors</h3>
            <div class="nearby-grid" id="nearbySensors">
                <div class="nearby-loading">Loading nearby sensors...</div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <p>Data from <a href="https://www.purpleair.com" target="_blank">PurpleAir</a> sensor network</p>
            <p class="sensor-details">
                Sensor: <span id="sensorModel">--</span> | 
                Firmware: <span id="firmware">--</span> |
                ID: <span id="sensorId">--</span>
            </p>
            <p class="disclaimer">ğŸš¬ Cigarette equivalence based on Berkeley Earth research (22 Âµg/mÂ³ PM2.5 â‰ˆ 1 cigarette/day)</p>
        </footer>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>
